import{d as f,y as w}from"./hooks.module.BXRoyx2g.js";import{u as e}from"./jsxRuntime.module.BLZlUNXw.js";import"./preact.module.BYSHj7yn.js";function P(r,l=""){const n=new Uint8Array(3e4);let t=0,a=0;const c=[],o=l.split("").map(h=>h.charCodeAt(0));let s=0;for(;a<r.length;){switch(r[a]){case">":t++,t>=n.length&&console.warn("Warning: Data pointer exceeded initial tape size. Behavior might be undefined.");break;case"<":if(t--,t<0)throw new Error("Data pointer went below zero.");break;case"+":n[t]=(n[t]+1)%256;break;case"-":n[t]=(n[t]-1+256)%256;break;case".":c.push(String.fromCharCode(n[t]));break;case",":s<o.length?(n[t]=o[s],s++):n[t]=0;break;case"[":if(n[t]===0){let d=1;for(;d>0;){if(a++,a>=r.length)throw new Error("Unmatched '[' bracket.");r[a]==="["?d++:r[a]==="]"&&d--}}break;case"]":if(n[t]!==0){let d=1;for(;d>0;){if(a--,a<0)throw new Error("Unmatched ']' bracket.");r[a]==="]"?d++:r[a]==="["&&d--}}break}a++}return c.join("")}function u(){return{data:new Uint8Array(3e4),dataPtr:0,codePtr:0,inputPtr:0,output:""}}function k(r,l,n){const t={...n,data:new Uint8Array(n.data)};if(t.codePtr>=r.length)return t;switch(r[t.codePtr]){case">":t.dataPtr++,t.dataPtr>=t.data.length&&console.warn("Warning: Data pointer exceeded initial tape size.");break;case"<":if(t.dataPtr--,t.dataPtr<0)throw new Error("Data pointer went below zero.");break;case"+":t.data[t.dataPtr]=(t.data[t.dataPtr]+1)%256;break;case"-":t.data[t.dataPtr]=(t.data[t.dataPtr]-1+256)%256;break;case".":t.output+=String.fromCharCode(t.data[t.dataPtr]);break;case",":t.inputPtr<l.length?(t.data[t.dataPtr]=l.charCodeAt(t.inputPtr),t.inputPtr++):t.data[t.dataPtr]=0;break;case"[":if(t.data[t.dataPtr]===0){let c=1;for(;c>0;){if(t.codePtr++,t.codePtr>=r.length)throw new Error("Unmatched '[' bracket.");r[t.codePtr]==="["?c++:r[t.codePtr]==="]"&&c--}}break;case"]":if(t.data[t.dataPtr]!==0){let c=1;for(;c>0;){if(t.codePtr--,t.codePtr<0)throw new Error("Unmatched ']' bracket.");r[t.codePtr]==="]"?c++:r[t.codePtr]==="["&&c--}}break}return t.codePtr++,t}function v({memoryState:r,visibleCells:l=20}){const t=(()=>{const a=Math.max(0,r.dataPtr-Math.floor(l/2)),c=Math.min(r.data.length,a+l),o=[];for(let s=a;s<c;s++)o.push({index:s,value:r.data[s],isCurrent:s===r.dataPtr});return o})();return e("div",{children:[e("div",{class:"font-bold text-xl mb-4",children:"Memory Visualization"}),e("div",{class:"bg-[#1a2e2a] rounded-2xl p-6 flex flex-col gap-4",children:[e("div",{class:"text-sm text-[#b2cfc7] mb-2",children:["Current Pointer: ",e("span",{class:"text-green-500 font-bold",children:r.dataPtr})]}),e("div",{class:"overflow-x-auto",children:e("table",{class:"w-full text-sm",children:[e("thead",{children:e("tr",{class:"border-b border-[#25413d]",children:[e("th",{class:"text-left py-2 px-3 text-[#b2cfc7]",children:"Cell"}),e("th",{class:"text-left py-2 px-3 text-[#b2cfc7]",children:"Value"}),e("th",{class:"text-left py-2 px-3 text-[#b2cfc7]",children:"ASCII"}),e("th",{class:"text-left py-2 px-3 text-[#b2cfc7]",children:"Binary"})]})}),e("tbody",{children:t.map(a=>e("tr",{class:`border-b border-[#22322f] hover:bg-[#25413d] transition-colors ${a.isCurrent?"bg-green-500/20 border-green-500":""}`,children:[e("td",{class:"py-2 px-3 font-mono",children:[e("span",{class:a.isCurrent?"text-green-500 font-bold":"text-white",children:a.index}),a.isCurrent&&e("span",{class:"text-green-500 ml-1",children:"←"})]}),e("td",{class:"py-2 px-3 font-mono text-[#7fffd4]",children:a.value}),e("td",{class:"py-2 px-3 font-mono text-[#8ca39a]",children:a.value>=32&&a.value<=126?String.fromCharCode(a.value):"·"}),e("td",{class:"py-2 px-3 font-mono text-xs text-[#8ca39a]",children:a.value.toString(2).padStart(8,"0")})]},a.index))})]})}),e("div",{class:"text-xs text-[#8ca39a] mt-2",children:["Showing cells ",t[0]?.index||0," - ",t[t.length-1]?.index||0,"(Total: 30,000 cells)"]})]})]})}function C({code:r,currentPosition:l,isStepping:n}){if(!n||l>=r.length)return null;const t=r[l],a=r.slice(Math.max(0,l-10),l),c=r.slice(l+1,l+11);return e("div",{class:"bg-[#1a2e2a] rounded-2xl p-4 mb-4",children:[e("div",{class:"text-sm text-[#b2cfc7] mb-2",children:"Code Position"}),e("div",{class:"font-mono text-sm",children:[e("span",{class:"text-[#8ca39a]",children:a}),e("span",{class:"bg-green-500 text-black px-1 rounded font-bold",children:t}),e("span",{class:"text-[#8ca39a]",children:c})]}),e("div",{class:"text-xs text-[#8ca39a] mt-1",children:["Position: ",l+1," / ",r.length,t&&` (${t})`]})]})}function B(){const[r,l]=f(""),[n,t]=f(""),[a,c]=f(""),[o,s]=f(!1),[h,d]=f(u()),b=()=>{try{if(!r.trim()){alert("Please enter some Brainfuck code");return}const i=P(r,n);c(i),p()}catch(i){alert("Error: "+i.message)}},g=()=>{if(o||(d(u()),s(!0)),h.codePtr>=r.length){c(h.output),s(!1);return}try{const i=k(r,n,h);d(i)}catch(i){alert("Error: "+i.message),s(!1)}},m=()=>{l(""),t(""),c(""),s(!1),p()},p=()=>{d(u())};return w(()=>{const i=localStorage.getItem("brainfuck-example-code"),x=localStorage.getItem("brainfuck-example-input");i&&(l(i),x&&t(x),localStorage.removeItem("brainfuck-example-code"),localStorage.removeItem("brainfuck-example-input"))},[]),e("div",{class:"min-h-screen flex flex-col",children:e("main",{class:"flex flex-col lg:flex-row flex-1 px-8 py-10 gap-12",children:[e("section",{class:"flex-1 w-full lg:max-w-xl mx-auto flex flex-col gap-8",children:[e("div",{children:[e("h1",{class:"text-3xl font-bold mb-4",children:"Brainfuck Interpreter"}),e("textarea",{value:r,onInput:i=>l(i.target.value),class:"input h-32 resize-none",placeholder:"Enter your Brainfuck code here..."})]}),e("div",{children:[e("div",{class:"font-bold mb-2 text-lg",children:"Input"}),e("input",{value:n,onInput:i=>t(i.target.value),class:"input",placeholder:"Enter input for the program..."})]}),e("div",{children:[e("div",{class:"font-bold mb-2 text-lg",children:"Output"}),e("div",{class:"input h-32",children:a})]}),e("div",{class:"flex gap-4 mt-2",children:[e("button",{onClick:b,class:"w-full py-3 rounded-full text-lg font-bold bg-primary text-bg hover:brightness-110 transition",children:"Run"}),e("button",{onClick:g,disabled:o&&h.codePtr>=r.length,class:`w-full py-3 rounded-full text-lg font-bold transition ${o&&h.codePtr>=r.length?"bg-gray-600 text-gray-400 cursor-not-allowed":"bg-[#25413d] text-white hover:bg-[#2e5c54]"}`,children:o?"Continue":"Step"}),e("button",{onClick:m,class:"w-full py-3 rounded-full text-lg font-bold bg-[#25413d] text-white hover:bg-[#2e5c54] transition",children:"Reset"})]})]}),e("aside",{class:"lg:w-2xl flex flex-col gap-8",children:[e(C,{code:r,currentPosition:h.codePtr,isStepping:o}),e(v,{memoryState:h})]})]})})}export{B as default};
